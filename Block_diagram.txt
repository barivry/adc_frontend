┌──────────────────────────────────────────────────────────────┐
│                            ADC                               │
│                                                              │
│   Analog Signal                                               │
│        │                                                     │
│        ▼                                                     │
│   [ ADC Core ]                                               │
│        │                                                     │
│        ├── LVDS Data[7:0]  ────────────────────────────┐    │
│        ├── DCO (Data Clock Output) ───────────────┐    │    │
│        └── FCO (Frame Clock Output) ───────────┐  │    │    │
└───────────────────────────────────────────────┼──┼────┼────┘
                                                │  │    │
                                                ▼  ▼    ▼
════════════════════════════ FPGA ═════════════════════════════════

====================  ADC CLOCK DOMAIN (dco_clk)  ==================

┌───────────────┐
│   IBUFDS      │  ← המרה פיזית מ-LVDS לדיגיטלי
│ (LVDS → logic)│
└───────┬───────┘
        │ lvds_data[7:0], dco_clk, fco
        ▼
┌─────────────────────────────┐
│   DDR Lane Capture (IDDR)   │  ← דגימה בעלייה + בירידה
│                             │
│  lane i:                    │
│   ├─ bit_rise[i]            │
│   └─ bit_fall[i]            │
└──────────────┬──────────────┘
               │
               ▼
┌─────────────────────────────┐
│   Deskew / Bitslip Control  │  ← תיקון פאזה דיגיטלי
│                             │
│   swap_edges[i]             │
│   bitslip[i]                │
└──────────────┬──────────────┘
               │
               ▼
┌─────────────────────────────┐
│     Word Assembler          │
│                             │
│  word[2*i]   = bit_rise[i]  │
│  word[2*i+1] = bit_fall[i]  │
│                             │
│  sample[13:0] = ADC sample  │
│  [15:14] = 0                │
└──────────────┬──────────────┘
               │
               │ sample_word[15:0]
               ▼
┌─────────────────────────────┐
│  FCO Alignment Monitor      │  ← בדיקת יישור מילים
│                             │
│  • בודק גבולות דגימה        │
│  • מזהה החלקות              │
│                             │
│  outputs:                   │
│   aligned                   │
│   align_err_cnt             │
└──────────────┬──────────────┘
               │
               ▼
┌─────────────────────────────┐
│    Async FIFO (CDC)         │  ← מעבר שעון בטוח
│                             │
│  write_clk = dco_clk        │
│  read_clk  = sys_clk        │
│                             │
│  protects from metastability│
└──────────────┬──────────────┘
               │
               │ data stream
               ▼

====================  SYSTEM CLOCK DOMAIN (sys_clk)  =================

┌─────────────────────────────┐
│   Stream Output Logic       │
│                             │
│  m_valid / m_ready          │
│  m_data[15:0]               │
│                             │
│  backpressure safe          │
└──────────────┬──────────────┘
               │
               ▼
┌─────────────────────────────┐
│ Trigger + Snapshot Engine   │
│                             │
│  • circular buffer          │
│  • pre / post trigger       │
│                             │
│  snap_ready / overrun       │
└──────────────┬──────────────┘
               │
               ▼
┌─────────────────────────────┐
│   Timestamp Counter         │
│                             │
│  free-running sys_clk time  │
└─────────────────────────────┘